---
title: Linux system pentesting
---

- [Attack scenarios](#attack-scenarios)
	- [Requirement](#requirement)
	- [Template](#template)
	- [Notes](#notes)
- [Attack vectors](#attack-vectors)
	- [Requirement](#requirement-1)
	- [Notes](#notes-1)
- [Methods and tools](#methods-and-tools)
	- [Bypass flow control](#bypass-flow-control)
	- [Elevate privileges](#elevate-privileges)
	- [Tamper/craft TOE outputs](#tampercraft-toe-outputs)


# Attack scenarios

## Requirement
**The evaluator _shall_ first read all SFRs/SF in the ST and define a table of scenarios to decline the following attacker objectives:**
 - **_Compromising the security_ of the TOE (the TOE is targeted for its own assets), or**
 - **_Compromising the trustworthiness_ of the TOE, a.k.a. _pivoting_ (the TOE is used is a springboard to compromise the security of _another product or system_ that uses/trusts it).**

**The evaluator _should_ use the following template as a basis, and add any other relevant scenario depending on the ST (other primary security functions of the TOE, _deeper_ support functions such as system hardening, secure boot, physical protection...)**

## Template 

| Security Function | _Compromise the security_ of the TOE | _Compromise the trustworthiness_ of the TOE | 
| :---- | :----   |          :--- | 
| Level 1 - Primary security feature(s) of the TOE. <br>_Example: information flow control (VPNs, diodes, firewalls...)._ | Bypass/disable the main security feature(s) and interface(s) of the TOE. <br>_Following the example: **Bypass flow control** (e.g. evading firewalling, tampering/eavesdropping protected traffic...)_| **Tamper/craft TOE outputs** so that its interfaces can be used to attack other users or IT Products | 
| Level 2 - Access control on the TOE | **Elevate privileges** in order to facilitate Level 1 scenarios | **Elevate privileges** in order to facilitate Level 1 scenarios | 
| Level 3 - Audit | **Tamper/craft TOE outputs**, typically compromise audit logs in order to facilitate or mask Level 2 scenarios | **Tamper/craft TOE outputs**, typically compromise audit logs in order to facilitate or mask Level 2 scenarios | 

## Notes 
 - The template is _levelled_ because SFs are not all born equal: some are meant to protect primary assets, and many others are merely there to support these primary SFs. 
 - The template defines the following _scenarios_ as a minimum:
	 - Bypass flow control
	 - Tamper/craft TOE outputs
	 - Elevate privileges
   They correspond to groups of SFs that are often found in most types of TOEs. They obviously need to be completed/adapted for each TOE.


# Attack vectors
## Requirement
The evaluator _shall_ explore _all the scenarios from all possible attack vectors_ unless proven irrelevant. 

## Notes 
 - Assumptions in the security target may lead to discard or otherwise limit some of these _as possible initial attack vectors_ (e.g. some groups of users may be trusted by assumption). However, privilege escalation plays a large part in the method: the evaluator may therefore "unlock" attack vectors during the evaluation, as they progress in their analysis: even if a vector is assumed trusted by the ST, it will have to be studied if an attacker can obtain access to this vector 
 - For the same reason, it is recommended to begin the analysis with the highest initial level of privilege granted to potential attackers. E.g. if attackers can have access to `User sessions (local or over the network), or userland code execution`, analyze this attack vector before analyzing `Anonymous network access`
 - the method of the pentester stays the same whether the TOE includes the Linux OS or not - however the evaluator needs to be careful to focus their efforts to the scope of the TOE.

# Methods and tools

## Bypass flow control
The typical example of flow control is a firewall TOE, which will filter/block/allow data traffic. The actual flow control functionality will depend on the TOE. 

In this example, _bypassing control flow_ means evading the FW rules. Similar types of attacks can concern diodes or gateways. Another example is the evasion of virtual networks segregation. 

All methods related to this topic can be found in the section *Evasion* of [Additional network methods](_0_Linux_pentest\2_Additional_network_methods.md)


## Elevate privileges

As a first step the evaluator **shall** first assess whether a general Privilege escalation is possible on the TOE. Hereafter a few examples of attack paths that can be realized through such an escalation:
 - Alter the services in charge of the firewall to allow evasion
 - Alter security-related data (e.g. allowed ciphersuites, SSH tunnelling options...) 
 - Alter content (include a covert/malicious payload in existing DNS or ICMP requests)
 - Alter audits logs change/delete records, or to trigger bugs on log-parsing tools  
 - Alter user interface for social engineering, e.g. to obtain credentials 
 - Read/write existing sockets in order to map/sniff the network from the TOE, or even send an arbitrary payload on a third-party.<br>Variation: install and/or run tools with such network capabilities
 - Generically: access any asset that is not allowed for this user in the ST: SSH credentials of other users in memory, other users data on the filesystem...
 - ...

The first step consists in trying to escalate privileges from each available attack vector. Methods are available for the following vectors:
 - [Anonymous network access](_0_Linux_pentest\Privilege_escalation\0_From_anonymous_network_access.md), including network or offline third-party services
 - [Applicative user session](_0_Linux_pentest\Privilege_escalation\1_From_user_applicative_session.md)
 - [Non-privileged code or command execution](_0_Linux_pentest\Privilege_escalation\2_From_User_code_or_cmd_exec.md)
 - [Non-privileged shell](_0_Linux_pentest\Privilege_escalation\3_From_user_shell.md)

Notes:
 - Two additional vectors are documented here for the sake of completeness, but are as a general rule out of scope of CC evaluations:
	 - [Root Shell](_0_Linux_pentest\Privilege_escalation\4_From_root_shell.md)
	 - [Kernel code execution](_0_Linux_pentest\Privilege_escalation\5_From_Kernel_code_execution.md) 
 - Depending on the conditions of the evaluation, the evaluator may want to exhaustively test all vectors or not. If exhaustiveness is not required, the evaluator needs to carefully chose whether to start with more privileged attack vectors (attack has potentially more impact) or less privileged (attack is potentially more accessible). It would make sense for an AVA_VAN.3 evaluation to address in priority the less privileged and most accessible attack vectors. 

## Tamper/craft TOE outputs

The only accessible inputs/outputs are those that transit on the network, whether they are data outputs (such as API for other IT products) or user outputs (web, rsyslog...)

The scenario consists in passing an input that will functionally be reflected as a malicious TOE output: This topic is typical for gateways or reverse proxies. A weaker version consists in using the TOE to tunnel malicious content.

These attack methods are described in the section *Pivot* of [Network privilege escalation method](_0_Linux_pentest\2_Additional_network_methods.md).

