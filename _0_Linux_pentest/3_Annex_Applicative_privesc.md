---
title: Applicative pentest
---

- [Privilege escalation in an applicative context](#privilege-escalation-in-an-applicative-context)
- [From no access - exposed preauth transactions](#from-no-access---exposed-preauth-transactions)
  - [Preauth attack surface](#preauth-attack-surface)
  - [Reauth and error management](#reauth-and-error-management)
  - [Access control](#access-control)
- [from access](#from-access)
- [Configuration issues](#configuration-issues)
- [Design issues](#design-issues)
- [Bugs](#bugs)
  - [What are we looking for?](#what-are-we-looking-for)
  - [Where?](#where)
  - [Application to C/C++ code](#application-to-cc-code)

# Privilege escalation in an applicative context
 - from no access: gaining access to an application
 - from user access:
   - horizontal privesc: gaining access to other users access or data
   - vertical privesc: gaining system command execution or code execution with the application privileges



# From no access - exposed preauth transactions
## Preauth attack surface
General hints:
 - are all the public exposed resources meant to be available in preauth? 
   - web pages
   - APIs
   - etc.
 - at the applicative layer of exposed resources, are there potential vulns? e.g. identification/authentication forms subject to XSS, SSRFs, etc. more generally [Bugs](#bugs) on a preauth interface 
 - at the underlying layers, what can be done: is it possible to communicate in HTTP before TLS is up? 
## Reauth and error management
General hints:
e.g. VPN. upon error, the tunnel may be closed. The configuration of the VPN will define whether new cleartext will be blocked, or passed in new tunnel or passed in cleartext -> possible leak
See bad strongswan FW rules (auto=start vs auto=route, issues with start_action=none, etc.)

## Access control
General hints:
 - does the stack share resources of different users in the same process, the same database?

# from access
to shell:
 - [Restricted shells](_0_Linux_pentest\3_Annex_Applications\Restricted_Shell.md) 
 - [Busybox](_0_Linux_pentest\3_Annex_Applications\Busybox.md)
 - other applications [TODO]

# Configuration issues
Check the config files!
Detailed examples for
 - [SSH](_0_Linux_pentest\3_Annex_Applications\SSH.md)
 - ...

# Design issues



# Bugs
## What are we looking for?

Language- or technology-related bugs

 0.	Applicable coding standards
 1.	Thread safety and concurrency
    
     a.	Double Free / Use after free

     b.	General Data Races/Toc-Tou
    
     c.	Memory leaks, Deadlocks

 2.	Input validation 
    
    a.	Buffer overflows
    
    b.	Code injection/Remote or Arbitrary Code Execution
    
    c.	Indirect object reference: directory traversal, auth bypass, redirect...

 3.	Output sanitizing    
    
    a.	Reflected injection attacks
    
    b.	External Entities
    
    c.	Insecure Deserialization 
 4.	Other issues 
    
    a.	hardening of control flow (if,  switch...) 
    
    b.	Improper Authentication (Design)
    
    c.	Math Errors : overflow, wraparound, division by 0...
    
    d.	Inappropriate Use of Default Values (Design) : default per-missions, etc. 
    
    e.	Use of unsafe legacy functions
 5.	Violation of applicable protocol design, RFC... (exactness)



## Where?

For non-upstream components, focus on: 
 - priority 0: preauth interfaces in proprietary code
 - priority 1: other interfaces in proprietary code
 - priority 2: other proprietary code and interfaces in patched open source code

For upstream components, complete review is often infeasible and unlikely to give interesting results in constraint time. Concentrate on known vulnerabilities (CVEs), pit-falls and best practice for the specific libraries.


## Application to C/C++ code
The method is refined for the following languages and contexts:

 - [C code review for AVA_VAN.3 evaluations](Pentesting_methods_and_tools\System_pentesting\Applicative_pentesting\Code_review VAN3\C_code_review_VAN3.md)
