# How to use this script
Copy-paste the following code in a Identification.sh script, then run it `sudo ./Identification.sh > Identification_results.md`
# Script
````
#!/bin/bash

echo "AVA Linux testing - identification"
echo "=================================="

echo "# TOE components"
echo "## kernel and distribution:"
echo "````" 
uname -a
echo "````" 
echo "## list of installed packages > in file packages.txt"
dpkg -l > packages.txt

echo "## Utilities:"
which nmap aws nc ncat netcat nc.traditional wget curl ping gdb base64 socat xterm doas sudo fetch docker lxc ctr runc rkt kubectl ssh sftp 2>/dev/null
echo "## Available compilers (cc, gcc, g++) or other languages environments (java, python, perl, php)"
which cc gcc g++ java make python python2 python3 python2.7 python2.6 python3.6 python3.7 perl php ruby 2>/dev/null
echo "# _Non-upstream_ TOE components"
echo "## repositories"
echo "````" 
egrep -v '^#|^ *$' /etc/apt/sources.list /etc/apt/sources.list.d/*
echo "````" 
echo "Check if the TOE uses http only mirrors, check nginx settings for https config and /etc/apt/ssl + /etc/apt/apt.conf.d for keys"
echo "## Privileges"
echo "Check ADV doc vs the following lists"
echo "**SUID and SGID binaries:**"
echo "````" 
find / -perm -u=s -type f 2&>1
find / -perm -g=s -type f 2&>1
echo "````" 
echo "**Programs with sudo privileges:**"
echo "````" 
sudo -l
echo "````" 
echo "**Programs with capabilities:**"
echo "````" 
getcap -r / 2>/dev/null
echo "````" 

echo "Services running (not only as root):"
echo "\`\`\`\`" 
ps -elf 
echo "\`\`\`\`" 
echo "Check cron resources"
echo "\`\`\`\`" 
for user in $(cut -f1 -d: /etc/passwd); do
    echo "Crontab for $user:"
    sudo crontab -u $user -l 2>/dev/null
    echo ""
done
echo "\`\`\`\`" 

# Resources

echo "# Resources"
echo "Are there any unusual elements, passwords, API keys in the environment variables?"
(env || set) 2>/dev/null

# Users and groups
echo "# Users and groups"
echo "## Users"
cat /etc/passwd 
echo "## Groups"
cat /etc/group 
echo "## Sudoers"
cat /etc/sudoers

## services

# File system and rives
echo "# File system and drives"

echo "## Filesystem"

echo "## Drives"
ls /dev 2>/dev/null | grep -i "sd"
cat /etc/fstab 2>/dev/null | grep -v "^#" | grep -Pv "\W*\#" 2>/dev/null

# Check hardening 
echo "# Hardening"
## ptrace (if 2 or higher, do not bother with ptrace process injection)
echo "## ptrace"
cat /proc/sys/kernel/yama/ptrace_scope
## AppArmor
echo "## AppArmor"
if [ `which aa-status 2>/dev/null` ]; then
    aa-status
  elif [ `which apparmor_status 2>/dev/null` ]; then
    apparmor_status
  elif [ `ls -d /etc/apparmor* 2>/dev/null` ]; then
    ls -d /etc/apparmor*
  else
    echo "Not found AppArmor"
fi
## Grsecurity
echo "## grsec"
(uname -r | grep "\-grsec" >/dev/null 2>&1 || grep "grsecurity" /etc/sysctl.conf >/dev/null 2>&1) && echo "Yes" || echo "Not found grsecurity"
## PaX
echo "## PaX"
(which paxctl-ng paxctl >/dev/null 2>&1 && echo "Yes" || echo "not found")
## Execshield
echo "## Execshield"
(grep "exec-shield" /etc/sysctl.conf || echo "not found")
## SElinux
echo "## SELinux"
(sestatus 2>/dev/null || echo "Not found")
## ASLR
echo "## ASLR (If 0, not enabled)"
(cat /proc/sys/kernel/randomize_va_space 2>/dev/null)

````
