---
title: Exploiting shell scripts for privilege escalation
updated: 2024-05-28 12:34:00Z
created: 2024-05-17 12:29:54Z
---

Attack vectors:
- Are there input parameters you can change?
- Does the script use external resources that may be changed?

# Exploiting input variables
## Does the shell use unquoted variables?
Tip: check the script for the use of input variables **without quotes**, for example in an if condition. 
In that case, you want to try to inject a string with simple quotes, in order to force the result of the if to always true or always false, e.g. by adding an OR or a AND.

Pratical example:
See the Rootme challenge - [ch16 - Bash - unquoted expression injection](../../../../Pentesting/Challenges%20and%20CTFs/Rootme/App-script/ch16%20-%20Bash%20-%20unquoted%20expression%20injection.md)

## does the shell use bash quoted variables
if quoted variables are used in a test -v expression, bash can expect that the variable is a table (e.g. `x[2]`), and the -v option will evaluate whatever is passed as an index *as an arithmetic operation*.

It means that you can pass a variable `x[$(any_command) >&2]` and it will execute the command in order to use its return value as an index.

Pratical example:
See the Rootme challenge [ch21 - Bash - quoted expression injection](../../../../Pentesting/Challenges%20and%20CTFs/Rootme/App-script/ch21%20-%20Bash%20-%20quoted%20expression%20injection.md)


# Exploiting external resources
## Race conditions
search for vulnerability patterns
- use of find with option -exec
- etc.

Practical example
See an example of find -exec vuln in [ch22 - Bash - race condition](../../../../Pentesting/Challenges%20and%20CTFs/Rootme/App-script/ch22%20-%20Bash%20-%20race%20condition.md)

