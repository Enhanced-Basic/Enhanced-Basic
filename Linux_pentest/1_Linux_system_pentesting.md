---
description: Linux system pentesting
---
# Table of contents
* Describe the main attack scenarios
* Available methods for usual scenarios

# Describe the main attack scenarios

The evaluator _shall_ first read all SFRs/SF in the ST and define a table of scenarios to detail the following attacker main objectives:

* _Compromising the security_ of the TOE (the TOE is targeted for its own assets), or
* _Compromising the trustworthiness_ of the TOE, a.k.a. _pivoting_ (the TOE is used is a springboard to compromise the security of _another product or system_ that uses/trusts it).

The evaluator _should_ use the following template as a basis, and add any other relevant scenario depending on the ST (other primary security functions of the TOE, _deeper_ support functions such as system hardening, secure boot, physical protection...)

## Template for scenario description

| Security Function                                                                                                                                     | Scenario to compromise the security of the TOE                                                                                                                                                                                               | Scenario to compromise the trustworthiness of the TOE                                                                      |
| ----------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------- |
| **Level 1 - Primary security feature(s) of the TOE.**<br>Example: information flow control (VPNs, diodes, firewalls...). | Bypass/disable the main security feature(s) and interface(s) of the TOE.<br>Following the example: Bypass flow control (e.g. evading firewalling, tampering/eavesdropping protected traffic...) | **Tamper/craft TOE outputs** so that its interfaces can be used to attack other users or IT Products           |
| **Level 2 - Access control and privileges on the TOE**                                                                                                | **Elevate privileges** in order to facilitate Level 1 scenarios                                                                                                                                                                  | **Elevate privileges** in order to facilitate Level 1 scenarios                                                |
| **Level 3 - Audit and accountability**                                                                                                                | **Tamper/craft TOE outputs**, typically compromise audit logs in order to facilitate or mask Level 2 scenarios                                                                                                                   | **Tamper/craft TOE outputs**, typically compromise audit logs in order to facilitate or mask Level 2 scenarios |

**Notes**

* The template is _levelled_ because SFs are not all born equal: some are meant to protect primary assets, and many others are merely there to support these primary SFs.
* The template defines 3 main _scenarios_ (Bypass flow control, Tamper/craft TOE outputs, Elevate privileges) - they correspond to groups of SFs that are often found in most types of TOEs. They obviously need to be completed/adapted for each TOE.

## Attack vectors

The security target defines several attack vectors as part of its threats and assumptions definition. The evaluator could be tempted to limit its analysis from these vectors (e.g. some groups of users may be trusted by assumption). However, privilege escalation plays a large part in the method: the evaluator may therefore "unlock" attack vectors during the evaluation, as they progress in their analysis: even if a vector is assumed trusted by the ST, it will have to be studied if an attacker can obtain access to this vector.

For this reason, it is recommended that the privilege escalation is tested prior to any other scenario: the other scenarios can then be tested from all attack vectors, including those unlocked by privilege escalation.

# Available methods for usual scenarios

## Elevate privileges

Methods are available for the following initial attack vectors:

* [Anonymous network access](Privilege_escalation/0_From_anonymous_network_access.md), including network-reachable or offline third-party services;
* [Applicative user session](Privilege_escalation/1_From_user_applicative_session.md);
* [Non-privileged code or command execution](Privilege_escalation/2_From_User_code_or_cmd_exec.md);
* [Non-privileged shell](Privilege_escalation/3_From_user_shell.md).

Notes:

* Two additional vectors are listed here for the sake of completeness, but are (at least in most cases) out of scope of CC evaluations:
  * [Root Shell](Privilege_escalation/4_From_root_shell.md)
  * [Kernel code execution](Privilege_escalation/5_From_Kernel_code_execution.md)
* This method assumes that the evaluator will exhaustively test all attack vectors. If exhaustiveness is not required, the evaluator will need to carefully chose whether to start with more privileged attack vectors (attack has potentially more impact) or less privileged (attack is potentially more accessible). It would make sense for an AVA_VAN.3 evaluation to address in priority the less privileged and most accessible attack vectors, but this method does not recommend any particular path.

## Bypass flow control

All methods related to this topic can be found in the section _Bypass flow control_ of [Additional network methods](2_Additional_network_methods.md)

## Tamper/craft TOE outputs

These attack methods are described in the section _Tamper/craft TOE outputs_ of [Additional network methods](2_Additional_network_methods.md).

